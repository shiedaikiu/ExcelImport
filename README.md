ุงู ูพุฑูฺู ฺฉ ASP.NET Core Web API ุงุณุช ฺฉู ุงูฺฉุงู:

โ ุฏุฑุงูุช ูุงู Excel
โ ุฎูุงูุฏู ุงุทูุงุนุงุช ุตูุฑุชุญุณุงุจ ู ุงููุงู ุขู
โ ุงุนุชุจุงุฑุณูุฌ ุฏุงุฏูโูุง
โ ุฐุฎุฑู ุฏุฑ ูพุงฺฏุงู ุฏุงุฏู ุจุง EF Core (Code-First)
โ ูุฏุฑุช ุฎุทุงูุง ู ูพุงูโูุง ฺฉุงุฑุจุฑ-ูพุณูุฏ

ุฑุง ูุฑุงูู ูโฺฉูุฏ.

๐ ุณุงุฎุชุงุฑ ูุงู Excel
๐งพ ุดุช ฑ โ ุตูุฑุชุญุณุงุจ
ุดูุงุฑู ุณุฑุงู ุตูุฑุชุญุณุงุจ	ุชุงุฑุฎ ู ุฒูุงู ุตูุฑุชุญุณุงุจ	ููุน ุฎุฑุฏุงุฑ	ฺฉุฏ ุงูุชุตุงุฏ ุฎุฑูุฏุงุฑ	ูุจูุบ ฺฉู ุตูุฑุชุญุณุงุจ
๐ฆ ุดุช ฒ โ ุงููุงู ุตูุฑุชุญุณุงุจ
ุดูุงุฑู ุณุฑุงู ุตูุฑุชุญุณุงุจ	ุดูุงุณู ฺฉุงูุง	ููุฏุงุฑ / ุชุนุฏุงุฏ	ูุจูุบ ูุงุญุฏ (ู)	ูุจูุบ ุชุฎูู	ูุฑุฎ ูุงูุงุช ุจุฑุงุฑุฒุด ุงูุฒูุฏู

๐น ุณุทุฑ ุงูู ุดุงูู ูุฏุฑูุง ุงุณุช ู ุฏุฑ ูพุฑุฏุงุฒุด ูุงุฏุฏู ฺฏุฑูุชู ูโุดูุฏ.

๐ ุชฺฉููููฺโูุง

.NET 8 / 9

ASP.NET Core Web API

Entity Framework Core (Code-First)

ExcelDataReader

FluentValidation (Core Package)

SQL Server / LocalDB

๐ ุฑุงูโุงูุฏุงุฒ ูพุฑูฺู
1๏ธโฃ ุฏุฑุงูุช ูพุฑูฺู
git clone <repo-url>
cd ExcelImport

2๏ธโฃ ุงุนูุงู Migrations
dotnet ef database update

3๏ธโฃ ุงุฌุฑุง
dotnet run


ุณูพุณ Swagger ุฏุฑ ุขุฏุฑุณ ุฒุฑ ุฏุฑ ุฏุณุชุฑุณ ุงุณุช:

https://localhost:5001/swagger

๐ ูุฏูโูุง ุฏุงููู
Bill (ุตูุฑุชุญุณุงุจ)

ูุฑ ุตูุฑุชุญุณุงุจ ฺูุฏ ููู ฺฉุงูุง ุฏุงุฑุฏ

ุงุชุตุงู ุงุฒ ุทุฑู BillSerial

Stuff (ููู ฺฉุงูุง)

ูุงุจุณุชู ุจู ุตูุฑุชุญุณุงุจ

๐ ููุงูู Validation
Bill
ููุฏ	ูุงููู
BillSerial	ููุท ุนุฏุฏุ ุญุฏุงฺฉุซุฑ 10 ุฑูู
CreateDate	ุจุง ูุฑูุช yyyy/MM/dd
BuyerType	ฺฉ ุงุฒ ููุงุฏุฑ Enum
TotalPrice	ุญุฏุงฺฉุซุฑ 2 ุฑูู ุงุนุดุงุฑ
TotalPrice	= ุฌูุน ูุจูุบ ุฎุงูุต ุงููุงู
(UnitPrice * Count) - Discount

Stuff
ููุฏ	ูุงููู
StuffId	ููุท ุนุฏุฏุ 13 ุฑูู
Count	ุนุฏุฏ ุชุง 2 ุฑูู ุงุนุดุงุฑ
UnitPrice	10 ุฑูู ุตุญุญ + 4 ุงุนุดุงุฑ
Discount	ูุซู UnitPrice
VAT	2 ุฑูู ุตุญุญ + 2 ุงุนุดุงุฑ
๐ฅ API Endpoint
POST /api/import-excel
ูุฑู ูุฑูุฏ
ูุงู	ููุน	ุชูุถุญ
file	IFormFile	ูุงู Excel
๐ง ุฑูุชุงุฑ ุณุณุชู
โ ุงฺฏุฑ ูุงู ูุนุชุจุฑ ุจุงุดุฏ
200 OK
ูุงู ุจุง ููููุช ุซุจุช ุดุฏ

โ ุงฺฏุฑ ูุงู ุฎุงู ุจุงุดุฏ
400 BadRequest
"ูุงู ุงฺฉุณู ุฎุงู ุงุณุช ู ุฏุงุฏูโุง ุจุฑุง ุซุจุช ูุฌูุฏ ูุฏุงุฑุฏ."

โ ุงฺฏุฑ ุดุชโูุง ูุฌูุฏ ูุฏุงุดุชู ุจุงุดูุฏ
400 BadRequest
"ุณุงุฎุชุงุฑ ูุงู ุงฺฉุณู ูุนุชุจุฑ ููโุจุงุดุฏ."

โ ุงฺฏุฑ ุฏุงุฏู ูุงูุนุชุจุฑ ุจุงุดุฏ

ูพุงู ุฎุทุง ุจุฑ ุงุณุงุณ Validator ุจุฑฺฏุฑุฏุงูุฏู ูโุดูุฏ

ูุซุงู:

ุดูุงุฑู ุณุฑุงู ุตูุฑุชุญุณุงุจ ุจุงุฏ ุนุฏุฏ ุญุฏุงฺฉุซุฑ 10 ุฑูู ุจุงุดุฏ

๐ ุงุฑุชุจุงุท ุตูุฑุชุญุณุงุจ ู ุงููุงู
Join Key
Bill.BillSerial  <โ> Stuff.BillSerial

EF Core Fluent API

ุฑุงุจุทู ฺฉ ุจู ฺูุฏ ุชุนุฑู ุดุฏู ุงุณุช

๐งช ุชุณุช ฺฉุฑุฏู ุงุฒ ุทุฑู Swagger

ฑ๏ธโฃ ุงุฑุณุงู ูุงู
ฒ๏ธโฃ ุจุฑุฑุณ ูพุงุณุฎ
ณ๏ธโฃ ุฏุฑ ุตูุฑุช ููููุช ุฏุงุฏู ุฏุฑ DB ุฐุฎุฑู ูโุดูุฏ

๐ก ูุฏุฑุช ุฎุทุงูุง

Validation Errors โ 400

Empty File โ 400

Invalid Excel โ 400

Server Error โ 500

๐ ูฺฉุงุช ููู

โ ุณุทุฑ ูุฏุฑ ุฎูุงูุฏู ููโุดูุฏ
โ Encoding.RegisterProvider ุซุจุช ุดุฏู
โ Culture-Safe Parse
โ ุฎุทุงูุง ูุงุฑุณ ูุณุชูุฏ
โ ุฎูุงูุฏู ุชุงุฑุฎ ุจู ูุฑูุช ุดูุณ ุงูฺฉุงูโูพุฐุฑ ุงุณุช
